var dataList,len,control,timer,root=window.player,audio=root.audioManager;function getData(o){$.ajax({type:"GET",url:o,success:function(o){console.log(o),len=(dataList=o).length,control=new root.controlIndex(len),root.render(o[0]),audio.getAudio(o[0].audio),root.pro.renderAllTime(o[0].duration),bindEvent(),bindTouch()},error:function(o){console.log(o)}})}function bindEvent(){$("body").on("play:change",function(o,t){audio.getAudio(dataList[t].audio),root.render(dataList[t]),"play"==audio.status&&(rotated(0),audio.play(),root.pro.start()),$(".img-box").attr("data-deg",0),$(".img-box").css({transform:"rotateZ(0deg)",transition:"none"}),root.pro.renderAllTime(dataList[t].duration)}),$(".prev").on("click",function(){var o=control.prev();$("body").trigger("play:change",o),"play"==audio.status?root.pro.start(0):(root.pro.update(0),root.pro.stop())}),$(".next").on("click",function(){var o=control.next();$("body").trigger("play:change",o),"play"==audio.status?root.pro.start(0):(root.pro.update(0),root.pro.stop())}),$(".play").on("click",function(){if("pause"==audio.status){var o=$(".img-box").attr("data-deg");console.log(o),rotated(o),audio.play(),root.pro.start()}else clearInterval(timer),audio.pause(),root.pro.stop();$(".play").toggleClass("playing")})}function rotated(o){clearInterval(timer),o=+o,timer=setInterval(function(){o+=2,$(".img-box").attr("data-deg",o),$(".img-box").css({transform:"rotateZ("+o+"deg)",transition:"all 1s linear"})},200)}function bindTouch(){var r=$(".pro-bottom").offset().left,n=$(".pro-bottom").offset().width;$(".slider").on("touchstart",function(o){root.pro.stop()}).on("touchmove",function(o){var t=(o.changedTouches[0].clientX-r)/n;root.pro.update(t)}).on("touchend",function(o){var t=(o.changedTouches[0].clientX-r)/n;if(0<=t&&t<=1){var a=t*dataList[control.index].duration;audio.playTo(a),$(".play").addClass("playing"),audio.status="play",root.pro.start(t)}})}getData("../mock/data.json");